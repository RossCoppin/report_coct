---
title: "To clean or not to clean? The effect of kelp-wrack clearing on particular organic matter content of beach soil around the Cape Peninsula, South Africa"
output:
  pdf_document:
    toc: yes
  word_document:
    fig_caption: yes
    keep_md: yes
    toc: yes
  html_notebook:
    fig_caption: yes
    toc: yes
---

```{r data prep, message=FALSE, warning=FALSE, include=FALSE}

library(ggplot2)
library(tidyverse)
library(lubridate)
library(vegan)
library(pastecs)
library(ggpubr)
library(reshape2)

# read in data frame

df <- read.csv("data/pom_data.csv", sep = ";")%>%
  filter(site != "Strandfontein resort")

meta <- read.csv("data/pom_metadata.csv", sep = ";")

meta_edit <- meta[ ,c(1,2,4,5)]
meta_lng <- melt(meta_edit, id.vars = c("date", "site"), value.name = "meters",                              variable.name = "area")

meta_kelp <- meta[ ,c(1,2,6,7)]

# Summary stats for pom data by date, site and area

df_sum <- df %>% 
  group_by(date, site, area) %>% 
  summarise(mean_pom = mean(pom, na.rm = T),
            min_pom = min(pom, na.rm = T),
            max_pom = max(pom, na.rm = T),
            range_pom = range(pom, na.rm = T)[2]-range(pom, na.rm = T)[1],
            sd_pom = sd(pom, na.rm = T)) %>%
  ungroup()
df_sum

# Summary stats for pom data, date and area

sum <- df %>% 
  group_by(date, area) %>% 
  summarise(mean_pom = mean(pom, na.rm = T),
            min_pom = min(pom, na.rm = T),
            max_pom = max(pom, na.rm = T),
            range_pom = range(pom, na.rm = T)[2]-range(pom, na.rm = T)[1],
            sd_pom = sd(pom, na.rm = T)) %>%
  ungroup()
sum

sum_site <- df %>% 
  group_by(date, site) %>% 
  summarise(mean_pom = mean(pom, na.rm = T),
            min_pom = min(pom, na.rm = T),
            max_pom = max(pom, na.rm = T),
            range_pom = range(pom, na.rm = T)[2]-range(pom, na.rm = T)[1],
            sd_pom = sd(pom, na.rm = T)) %>%
  ungroup()
sum_site

# Summary stats for meta data (transect lengths)

meta_sum <- meta_lng %>% 
  group_by(date, area) %>% 
  summarise(mean_meters = mean(meters, na.rm = T),
            min_meters = min(meters, na.rm = T),
            max_meters = max(meters, na.rm = T),
            range_meters = range(meters, na.rm = T)[2]-range(meters, na.rm = T)[1],
            sd_meters = sd(meters, na.rm = T)) %>%
  ungroup()
meta_sum

```

\newpage

# Introduction
## Background

Kelps dominate approximately 25% of global, shallow, rocky reef ecosystems and play a significant role in the functioning of these ecosystems. Kelps are 'ecosystem engineers' that provide a critical 3-dimensional habitat for fauna and various flora, and they are also highly productive organisms [@Santelices1984; @Dayton1985; @Steneck2002]. The high productivity of kelps allows important nutrients to be exported to adjacent and distant habitats as allochthonous production, and therefore their role in the food web is not limited to the shallow subtidal zone; instead they are the base for many connected coastal food webs [@Stuart1982; @Dayton 1985; @Bustamante1996; @Duggins1997; @Kelly2005; @Miller2012; @Krumhansl2014]. Environmental factors such as nutrients [@Jackson1977; @Field1980b; @Fram2008],turbidity , light [@Reed1984; @Graham1997; @Toohey2004; @Wernberg2005; @Bennett2015], sedimentation [@Kennelly1983; @Vadas1992; @Madsen2001; @Schiel2006], temperature [@Novaczek1984; @Wiencke1989; @Rothausler2009; @Wernberg2010; @Bolton2012; @Verges2014; @Verges2016; @Basford2016 and hydrodynamics [@Seymour1989; @Dayton1992; @Utter1996; @Kawamata2001; @Taylor2003; @Fowler-Walker2006] have been shown to affect the growth, recruitment and recovery of kelps [@Wernberg2010; @Mohring2014].

Sandy beach ecosystems have low amounts of productivity compared to other ecosystems such as rocky and estuarine mud-flats, with most of the productivity in sandy beach ecosystems represented by diatoms. Primary productivity of diatoms tends to be higher on beaches with fine soil grain and low wave exposure, but never reach levels compared to other ecosystems. Macrofaunal communities on sandy beach ecosystems rely heavily  on organic inputs from the surf zone (diatoms and flagellates) or from the ocean (kelp-wrack, carrion, dissolved organics and particulates). These inputs are regulated by oceanographic processes such as upwelling, currents, waves and tidal action. Primary consumers in the form of suspension feeders and herbivores, consume phytoplankton, particulate organic matter, kelp and seagrasses which in turn become prey items for secondary consumers (invertebrates). Predatory species (fish, lizards, shorebirds, baboons ect) prey upon both primary and secondary consumers as well as drift carrion. Therefore, allochthonous input plays an important role in maintaining sandy beach food webs from a bottom-up perspective. Kelps provide a significant amount to the overall allochthonous input in the form kelp-wrack found on sandy beaches in many coastal areas around the world. When kelp biomass accumulates on a beach is undergoes various biotic and abiotic processes. These processes of fragmentation, decomposition and remineralisation by bacteria, meiofauna and grazers. Once kelp biomass has been fragmented and/or mineralised, it can then be transported to the nearshore marine environment, or enter the atmosphere and be transported via wind to adjacent terrestrial ecosystems or stored _in situ_ within the beach soil.


## Beach-cast in South Africa

Beach-cast kelp biomass around the Cape Peninsula is a consistent characteristic of beaches in the region. Kelps washed up on beaches originate from near or offshore kelp populations. During times of high wave energy or pulse disturbance events such as storms, kelps dislodge or stipes break which essentially kills the plant as it has no way of re-attaching itself. Kelp species are deposited on beaches by coastal currents on almost a daily basis, and consist mainly of two species, e.g. _Ecklonia maxima_ and _Laminaria pallida_, and form what is known as beach-cast kelp or simply beach-cast. Beach-cast is an important organic input into sandy beach ecosystems, and through wind, may be transported to adjacent and distant ecosystems. In sandy beach ecosystems, kelp detritus is important in sustaining marine invertebrate communities, which in turn are important prey items for various bird species. ?add study by koop?

Drift kelp that washes up on beaches around the Western Cape are managed by two agencies; the City of Cape Town (CCT) and the Department of Agriculture, Forestry and Fisheries (DAFF). These two agencies differ in their perspectives on managing _E. maxima_ beach cast. DAFF monitors the collection of beach cast kelp for the South African coastline by issuing permits that allow  rights holders to collect kelp for commercial reasons within specific concession areas. The commercial demand for beach cast kelp is not consistent and therefore rights holders may only collect during times of high demand. Examples of commercial applications of beach cast kelp are alginate production, pharmaceuticals and abalone feed. 

Within the concession areas, there are regions designated as Marine Protected Areas by South African National Parks (SANParks), and no kelp is collected from these areas. This is due to the ecological significance of beach cast kelp in coastal ecosystems. Kelp that is washed ashore is an important source of nutrients for invertebrate communities and provides an important bottom-up control mechanism for beach ecosystems. Furthermore, research elsewhere in the world has shown that beach cast kelp is important in the formation and stabilisation of dunes. Although it has a significant role to play in beach systems, the decomposition process of kelp releases a foul odour in the form of hydrogen sulphide. This is a point of concern for ratepayers who complain that the kelp needs to be removed for aesthetic reasons. The CCT both recognises the ecological significance of beach cast kelp and is cognizant of the concern of ratepayers and the possible negative consequences on tourism at specific beaches (e.g. Clifton beach and Camps Bay) due to the smell and other unsatisfactory conditions caused by decomposing kelp. The CCT, therefore, collects beach cast kelp from predetermined beaches and disposes the kelp in landfills as there is currently no procedures in place to process and dispose of kelp in a sustainable manner.

Since kelp biomass has been shown to be an important detrital input in sandy beach ecosystems, the removal of beach-cast may therefore affect the overall particular organic matter (POM) content available within the soil of sandy beaches, which could possibly lead to a bottom-up affect on food webs.


## Aims and Objectives

The aim of this study was to determine if clearing of kelp from beaches affects POM content of beach soil. This aim will be met through the following objectives:
1) Determine if there are any differences in POM content of cleared and non-cleared areas of selected beaches.
2) Determine if differences in POM content are driven by other factors such as kelp biomass, wind and transect length.

# Study sites
## Hout Bay east and west

Hout Bay bay beach is essentially one beach divided by the mouth of the Disa river. The Disa river is highly polluted, with a clear warning sign in view for beach-goers. Due to residential development the mouth of the river closes more frequently causing a build-up of polluted water. 

On the east side, the "cleared" area of the beach is characterised by a large parking lot, residential and commercial structures, and forms the "no dogs allowed" of Hout Bay beach. Activity on the beach tends to be high in the morning and slows down in the afternoon. Small dunes with low vegetation cover are located behind the "non-cleared" area. Shell debris is not uncommon in the non-cleared area.

On the west side, the cleared area comprises a small parking lot and wharf which forms one end of the Hout Bay harbour, as well as a storm water pipe mouth in the parking area leading onto the beach. This is the "dog-walking" section of beach, which continues until the Disa river mouth. Activity is high in the morning and weekends, and attract beach-goers due to the wharf and harbour.The non-cleared area is characterised by dunes and little vegetation cover. During the course of this study, the non-cleared area was undergoing stabilisation/rehabilitation construction. The dunes were first graded and then fencing was placed, which covered the entire dune system. 

## Muizenberg

Muizenburg is was the largest beach in the study compared to other beaches sampled in this study. The cleared area comprises of a parking lot with commercial structures such as restaurants and various shops, which attracts beach-goers to this area of beach. The non-cleared section has a slightly lower activity and consists of a mixture of structures (beach huts, bridge), and dune system with established vegetation. Shell debris is common closer to the surf zone and litter is common throughout.

## Fishoek

Fishoek was the smallest beach in the study , with an approximate length of ?? and width ??. The cleared area comprises of a large parking lot and small commercial and public structures (restaurant, playground, police services etc.) and two storm water pipes on either end of the area. The non-cleared area of beach comprises a dune system with established vegetation. A railway track is located behind the dune system. 

On both area dog-walking is allowed and activity tended to be lower compared to other beaches in the study. Both areas were also well maintained with no litter found during the course of the study.

## Strandfontein

The cleared area is characterised by a large parking lot, beach pavilion and tidal pool. There is also construction activities between the tidal pool wall and beach. Activity is fairly high relative to the other beaches in the study. The non-cleared area has low activity and characterised by and extensive dune system and established vegetation. The beach is fairly well maintained and very low amount of litter was noted. Shell debris was common in surf zone in both areas.  

# Methods
## Data collection

Various beaches are around Cape Town have been divided up into 'cleared' and 'non-cleared' areas by the City of Cape Town. These were sampled for POM content in the soil by sampling between the low-tide and high-tide line, or as far as possible if any structures were in the way. Each transect was divided up into 5 sections according to the length of the transect on that particular sampling occasion. Soil samples 20cm deep were taken each time and placed in a small ziplock bag and labelled. Each sample was weighed, dried, re-weighed, placed in a muffle furnace and finally re-weighed. The difference between in grams between the start and end weight was used as an estimate as particulate organic matter content. 

## Data analysis

All data analyses were done using the R software [@RCoreTeam2016], and the vegan
package [@Oksanen2016] and ggplot2 [@Wickham 2009]Summary statistics were calculated and the Shapiro-Wilk normality test was run before any analyses to investigate the distribution of the data.Summary statistics were calculated and the Shapiro-Wilk normality test was run before any analyses to investigate the distribution of the data. Where data was normally distributed ANOVA was used to test for significant differences.Various non-parametric visual comparisons and Kruskal-Wallis Rank Sum Test was used to test for any significant differences for data that deviated from a normal distribution.

## Cleared and Non-cleared areas

The POM data for entire study was pooled into cleared and non-cleared categories. These data included all sampling days of the study. A Kruskal-Wallis test was used to test for differences in POM between cleared and non-cleared areas. A boxplot was used to visualise any differences in POM between cleared and non-cleared areas.

## Cleared and Non-cleared areas in each month

The data for each sampling date were pooled into months during which the study took place (February, March, April) as well as cleared and non-cleared areas. A combination of scatter plot and boxplot was used to investigate any differences in POM visually and a Kruskal-Wallis test was used to test any differences statistically.  

## Cleared and Non-cleared areas between sites

Data was grouped according to site and area. This allowed investigation into any possible differences in POM between sites. A boxplot was used to allow visual comparison of POM between sites and areas, and a Kruskal-Wallis test was used to verify findings. 

## Correlations

To investigate if transect length and kelp estimates may be affecting POM content sampled, correlation between paired samples was performed. To investigate whether transect length is correlated to POM, the mean transect length and POM was calculated for cleared and non-cleared areas on a given sampling day, and then correlated. To investigate whether beach-cast kelp influenced POM, the mean POM and transect length was calculated by day, site and area, and then correlated. This approach for the beach-cast kelp estimates and POM correlations was chosen as kelp estimates were performed separately for both cleared and non-cleared areas. 

# Results
## Cleared and Non-cleared areas

```{r norm test, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

stat.desc(df, basic = TRUE, desc = TRUE, norm = TRUE, p = 0.95)
stat.desc(meta, basic = TRUE, desc = TRUE, norm = TRUE, p = 0.95)

```

Shapiro-Wilk's normality test showed that POM data was not normally
distributed across samples (w = 0.971, p < 0.05). Visual comparison and a Kruskal-Wallis test showed no significant difference in total POM (p < 0.05, Figure 1) between cleared and non-cleared areas. The cleared category had a slightly higher POM median than the non-cleared category (see Figure 1).

```{r cleared vs non-cleared, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

kruskal.test(data = df, pom~area) 
kruskal.test(data = meta_lng, meters~area) 
kruskal.test(data = meta_sum, mean_meters~area) 

```

```{r, fig.cap="Boxplots comparing POM and transect distance between cleared and non-cleared areas, the horizontal black lines represent the median. If 'notches' do not overlap, the medians are considered to be statistically different. The lower and upper 'hinges'correspond to the first and third quartiles, and the 'whiskers' are the 5th and 95th percentiles. Pink boxes represent cleared areas and blue boxes represent non-cleared areas", echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

# comparison between mean pom in cleared and non-cleared areas overall

boxplot <- ggplot(data = df, aes(x = area, y = pom)) +
  geom_boxplot(aes(fill = area), notch = TRUE, outlier.shape=NA, show.legend = FALSE) +
  theme(panel.background = element_rect(fill = 'white', colour = 'grey')) + 
  xlab("Area") + 
  ylab("POM (grams)") +
  theme(aspect.ratio = 0.8) +
  coord_cartesian(ylim = c(0, 1))

boxplot_meta <- ggplot(data = meta_lng, aes(x = area, y = meters)) +
  geom_boxplot(aes(fill = area), notch = TRUE, outlier.shape=NA, show.legend =   FALSE) +
  theme(panel.background = element_rect(fill = 'white', colour = 'grey')) + 
  xlab("Area") + 
  ylab("Distance (meters)") +
  theme(aspect.ratio = 0.8) 

ggarrange(boxplot + rremove("x.text"), boxplot_meta + rremove("x.text"))

```

## Cleared and Non-cleared areas in each month

No significant differences between cleared and non-cleared areas were found over the course of the study (see Figure 2). These findings were verified by a Kruskal-Wallis test which showed no significant differences (p < 0.05, Figure 2) in POM between cleared and non-cleared areas over the three months sampling took place. The cleared areas had a slightly higher median POM than non-cleared areas, except for April which showed a higher POM value for non-cleared areas.

```{r kwtest_months, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

df_month <- df%>%
            mutate(date = lubridate::month(date, label = TRUE))
kruskal.test(data = df_month, pom~area, subset = date) # where y1 is numeric and A is a factor

```

```{r boxplot, fig.cap="Boxplots comparing POM and transect distance between cleared and non-cleared areas, the horizontal black lines represent the median. If 'notches' do not overlap, the medians are considered to be statistically different. The lower and upper 'hinges'correspond to the first and third quartiles, and the 'whiskers' are the 5th and 95th percentiles. Pink boxes represent cleared areas and blue boxes represent non-cleared areas", echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

# comparison of pom in cleared and non-cleared areas between months

boxplot_month <- ggplot(data = df_month, aes(x = date, y = pom, fill = area)) +
  geom_boxplot(notch = TRUE, outlier.shape = NA, show.legend = FALSE) +
  theme(panel.background = element_rect(fill = 'white', colour = 'grey')) + 
  xlab("Month") + 
  ylab("POM (grams)") +
  theme(aspect.ratio = 0.8) +
  coord_cartesian(ylim = c(0, 1.5))

meta_lng_month <- meta_lng%>%
            mutate(date = lubridate::month(date, label = TRUE))

boxplot_meta_month <- ggplot(data = meta_lng_month, aes(x = date, y = meters, fill = area)) +
  geom_boxplot(inherit.aes = TRUE, notch = TRUE, outlier.shape=NA, show.legend = FALSE) +
  theme(panel.background = element_rect(fill = 'white', colour = 'grey')) + 
  xlab("Month") + 
  ylab("Distance (meters)") +
  theme(aspect.ratio = 0.8) 

ggarrange(boxplot_month + rremove("x.text"), boxplot_meta_month + rremove("x.text"))



```

## Cleared and Non-cleared areas between sites

Significant differences were found for both POM and transect length between areas within sites. POM in cleared areas was significantly higher at all sites, with Muizenberg being the exception (see Figure 3). Visual comparison showed significantly higher transect lengths for non-cleared areas than cleared areas at all sites with both Hout Bay west and east being exceptions.

```{r kwtest_site, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
kruskal.test(data = df, pom~area, subset = site) # where y1 is numeric and A is a factor

```

```{r, fig.cap="Boxplots comparing POM and transect length in cleared and non-cleared areas between sites, the horizontal black lines represent the median. If 'notches' do not overlap, the medians are considered to be statistically different. The lower and upper 'hinges'correspond to the first and third quartiles, and the 'whiskers' are the 5th and 95th percentiles. Pink boxes represent cleared areas and blue boxes represent non-cleared areas", echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

# comparison of pom in cleared and non-cleared areas between sites

boxplot_site <- ggplot(data = df, aes(x = site, y = pom)) +
  geom_boxplot(aes(fill=area), notch = TRUE, outlier.shape = NA, show.legend = FALSE) +
  theme(panel.background = element_rect(fill = 'white', colour = 'grey')) + 
  xlab("") + 
  ylab("POM (grams)") + 
  theme(axis.text.x=element_text(angle = 90, hjust = 1, vjust = 0.3)) +
  theme(aspect.ratio = 0.8) +
  coord_cartesian(ylim = c(0, 1.2))

boxplot_meta_site <- ggplot(data = meta_lng, aes(x = site, y = meters)) +
  geom_boxplot(aes(fill = area),inherit.aes = TRUE, notch = TRUE, outlier.shape=NA, show.legend =   FALSE) +
  theme(panel.background = element_rect(fill = 'white', colour = 'grey')) + 
  xlab("") + 
  ylab("Distance (meters)") +
  theme(aspect.ratio = 0.8) + 
  theme(axis.text.x=element_text(angle = 90, hjust = 1, vjust = 0.3))

ggarrange(boxplot_site, boxplot_meta_site)

```

## Correlations

No significant correlation was found between transect length and POM (z = -1.072, p > 0.05) or kelp estimates in cleared (z = -1.040, p > 0.05) and non-cleared (z = -0.491, p> 0.05) areas.

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=TRUE}

cor.test(sum$mean_pom, meta_sum$mean_meters, continuity = TRUE, method = "kendall", exact = TRUE, subset = area)

cor.test(sum_site$mean_pom, as.numeric(meta_kelp$cast_cleared), method = c("kendall"), continuity = TRUE)
cor.test(sum_site$mean_pom, as.numeric(meta_kelp$cast_noncleared), method = c("kendall"), continuity = TRUE)

```

# Discussion

# Limitations and recommendations

## References





